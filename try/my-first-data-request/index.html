



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://docs.witnet.io/try/my-first-data-request/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.1.0">
    
    
      
        <title>Create a Data Request - Witnet Protocol Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.11e41852.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.20ef595d.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="deep-purple">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#create-a-data-request" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <!--
  Copyright (c) 2016-2019 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Application header -->
<header class="md-header" data-md-component="header">

    <!-- Top-level navigation -->
    <nav class="md-header-nav md-grid">
        <div class="md-flex">

            <!-- Link to home -->
            <div class="md-flex__cell md-flex__cell--shrink">
                <a href="https://docs.witnet.io"
                   title="Witnet Protocol Documentation"
                   class="md-header-nav__button md-logo">
                    
                    <img src="../../assets/images/logo.svg" alt="Witnet Logo" height="26" />
                    
                </a>
            </div>

            <!-- Button to toggle drawer -->
            <div class="md-flex__cell md-flex__cell--shrink">
                <label class="md-icon md-icon--menu md-header-nav__button"
                       for="__drawer"></label>
            </div>

            <!-- Header title -->
            <div class="md-flex__cell md-flex__cell--stretch">
                <div class="md-flex__ellipsis md-header-nav__title"
                     data-md-component="title">
                    
                    <a href="https://docs.witnet.io" class="md-header-nav__topic">the <strong>witnet</strong> documentation</a>
                    <span class="md-header-nav__topic">
              
                Create a Data Request
              
            </span>
                    
                </div>
            </div>

            <!-- Button to open search dialogue -->
            <div class="md-flex__cell md-flex__cell--shrink">
                
                <label class="md-icon md-icon--search md-header-nav__button"
                       for="__search"></label>

                <!-- Search interface -->
                
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
                
            </div>

            <!-- Repository containing source -->
            
            <div class="md-flex__cell md-flex__cell--shrink">
                <div class="md-header-nav__source">
                    


  


  <a href="https://github.com/witnet/documentation/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      witnet/documentation
    </div>
  </a>

                </div>
            </div>
            
        </div>
    </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.witnet.io" title="Witnet Protocol Documentation" class="md-nav__button md-logo">
      
        <img src="../../assets/images/logo.svg" alt="Witnet Logo" width="48" height="48">
      
    </a>
    Witnet Protocol Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/witnet/documentation/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      witnet/documentation
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Ecosystem" class="md-nav__link">
      Ecosystem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/concepts/" title="What is Witnet?" class="md-nav__link">
      What is Witnet?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/software/" title="Software" class="md-nav__link">
      Software
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Quickstart
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Quickstart
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../run-a-node/" title="Run a Node" class="md-nav__link">
      Run a Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../use-from-ethereum/" title="Connect your Ethereum contracts to external APIs" class="md-nav__link">
      Connect your Ethereum contracts to external APIs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/bitcoin-price-feed/introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/bitcoin-price-feed/create-project/" title="1. Create a new project" class="md-nav__link">
      1. Create a new project
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/bitcoin-price-feed/sources/" title="2. Adding data sources" class="md-nav__link">
      2. Adding data sources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/bitcoin-price-feed/aggregations/" title="3. Define aggregations" class="md-nav__link">
      3. Define aggregations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/bitcoin-price-feed/fine-tuning/" title="4. Fine-tune the request" class="md-nav__link">
      4. Fine-tune the request
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/bitcoin-price-feed/compiling/" title="5. Compile the request" class="md-nav__link">
      5. Compile the request
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/bitcoin-price-feed/contract/" title="6. Write the Solidity contract" class="md-nav__link">
      6. Write the Solidity contract
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/bitcoin-price-feed/migrations/" title="7. Deploy" class="md-nav__link">
      7. Deploy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/bitcoin-price-feed/recap/" title="Recap" class="md-nav__link">
      Recap
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Community
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Community
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../community/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../community/roadmap/" title="Roadmap" class="md-nav__link">
      Roadmap
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Protocol Docs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Protocol Docs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-1" type="checkbox" id="nav-5-1">
    
    <label class="md-nav__link" for="nav-5-1">
      Witnet Requests
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-1">
        Witnet Requests
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocol/data-requests/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocol/data-requests/radon-encoding/" title="Encoding" class="md-nav__link">
      Encoding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../protocol/data-requests/examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Operator Docs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Operator Docs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ethereum/run-a-bridge.md" title="Run an Ethereum bridge" class="md-nav__link">
      Run an Ethereum bridge
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      More
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        More
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <!--
  Copyright (c) 2016-2019 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->



<!-- Table of contents -->
<nav class="md-nav md-nav--secondary">
    

    <!--
      Hack: check whether the content contains a h1 headline. If it does, the
      top-level anchor must be skipped, since it would be redundant to the link
      to the current page that is located just above the anchor. Therefore we
      directly continue with the children of the anchor.
    -->
    
    
    

    <!-- Render item list -->
    
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
        
        <li class="md-nav__item">
  <a href="#create-a-new-witnet-enabled-node-project" title="Create a new Witnet-enabled Node project" class="md-nav__link">
    Create a new Witnet-enabled Node project
  </a>
  
</li>
        
        <li class="md-nav__item">
  <a href="#add-witnet-request-to-your-existing-node-project" title="Add witnet-request to your existing Node project" class="md-nav__link">
    Add witnet-request to your existing Node project
  </a>
  
</li>
        
        <li class="md-nav__item">
  <a href="#write-your-first-witnet-request" title="Write your first Witnet request" class="md-nav__link">
    Write your first Witnet request
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#import-the-library" title="Import the library" class="md-nav__link">
    Import the library
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#define-the-data-sources" title="Define the data sources" class="md-nav__link">
    Define the data sources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#define-the-aggregator-script" title="Define the aggregator script" class="md-nav__link">
    Define the aggregator script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#define-the-tally-script" title="Define the tally script" class="md-nav__link">
    Define the tally script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#put-everything-together" title="Put everything together" class="md-nav__link">
    Put everything together
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#next-steps" title="Next steps" class="md-nav__link">
    Next steps
  </a>
  
</li>
        

        <!-- Source files -->
        

        <!-- Set from config but allow override -->
        
        

        <!-- Disqus integration -->
        
    </ul>
    
</nav>
<aside class="disclaimer">

</aside>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/witnet/documentation/blob/master/docs/try/my-first-data-request.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="create-a-data-request">Create a Data Request<a class="headerlink" href="#create-a-data-request" title="Permanent link">&para;</a></h1>
<p>Witnet data requests can be easily created with the <code class="codehilite">witnet-request</code>
Javascript library. If you know some Javascript, you have already done
the hardest part!</p>
<h2 id="create-a-new-witnet-enabled-node-project">Create a new Witnet-enabled Node project<a class="headerlink" href="#create-a-new-witnet-enabled-node-project" title="Permanent link">&para;</a></h2>
<p>When creating a new project from scratch, the quickest way to get
things working is using <a href="https://www.trufflesuite.com/">Truffle</a> to import a Witnet-enabled
project template:
<div class="codehilite"><pre><span></span><span class="go">truffle unbox witnet/truffle-box</span>
</pre></div></p>
<p>If you prefer not to use Truffle, you are OK to go with plain <code class="codehilite">npm</code> or
<code class="codehilite">yarn</code>:</p>
<div class="superfences-tabs">
<input name="__tabs_1" type="radio" id="__tab_1_0" checked="checked" />
<label for="__tab_1_0">npm</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="go">mkdir my-first-witnet-project</span>
<span class="go">cd my-first-witnet-project</span>
<span class="go">npm init</span>
<span class="go">npm install --save witnet-request</span>
</pre></div></div>
<input name="__tabs_1" type="radio" id="__tab_1_1" />
<label for="__tab_1_1">yarn</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="go">mkdir my-first-witnet-project</span>
<span class="go">cd my-first-witnet-project</span>
<span class="go">yarn init</span>
<span class="go">yarn add witnet-request</span>
</pre></div></div>
</div>
<h2 id="add-witnet-request-to-your-existing-node-project">Add <code class="codehilite">witnet-request</code> to your existing Node project<a class="headerlink" href="#add-witnet-request-to-your-existing-node-project" title="Permanent link">&para;</a></h2>
<p>If you want to build support for Witnet into your existing project, you
can simply add the <code class="codehilite">witnet-request</code> contract as a dependency:</p>
<div class="superfences-tabs">
<input name="__tabs_2" type="radio" id="__tab_2_0" checked="checked" />
<label for="__tab_2_0">npm</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="go">npm install --save witnet-request</span>
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_1" />
<label for="__tab_2_1">yarn</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="go">yarn add witnet-request</span>
</pre></div></div>
</div>
<h2 id="write-your-first-witnet-request">Write your first Witnet request<a class="headerlink" href="#write-your-first-witnet-request" title="Permanent link">&para;</a></h2>
<p>In this example we will:</p>
<ul>
<li>Query <strong>two different APIs</strong> for the USD price of a bitcoin using <strong>4
  witnessing nodes</strong> from Witnet.</li>
<li>Tell those nodes to <strong>aggregate</strong> the values from both APIs and report
  the result.</li>
<li>Define how to <strong>tally</strong> the results reported by the different nodes
  into <strong>a single data point</strong> that can be consumed by a smart contract.</li>
</ul>
<p><em>Ok, time to get down to work</em>. First off, create a <code class="codehilite">BitcoinPrice.js</code>
file where you will write the request. You can place it anywhere, but it
is recommended to put all the request files inside your project in a
single directory called <code class="codehilite">requests</code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you are using the Truffle template, you already have a <code class="codehilite">requests</code>
folder in your project. That is totally the right place to create the
<code class="codehilite">BitcoinPrice.js</code> file.</p>
</div>
<h3 id="import-the-library">Import the library<a class="headerlink" href="#import-the-library" title="Permanent link">&para;</a></h3>
<p>Importing the <code class="codehilite">witnet-request</code> library into your <code class="codehilite">BitcoinPrice.js</code>
request is pretty straightforward:</p>
<div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">Witnet</span> <span class="nx">from</span> <span class="s2">&quot;witnet-request&quot;</span>
</pre></div>

<h3 id="define-the-data-sources">Define the data sources<a class="headerlink" href="#define-the-data-sources" title="Permanent link">&para;</a></h3>
<p>Data sources are each of the endpoints from which you want the
witnessing nodes to retrieve the data. Most times, these will be the
URLs of public APIs.</p>
<p>The number of sources in a single data request is unlimited⁠—although
the more sources, the higher the fees.</p>
<p>Each source can have a companion script that lists operations that we
want the witnesses to apply on the retrieved data. This enables you to
extract the information of your interest out of larger data structures
like JSON objects.</p>
<p>The scripting language in data request is quite rich indeed: in addition
to selecting specific pieces of data, you can also transform those so
they are uniform and can be compared or aggregated together. E.g.
imagine a weather forecast data request. One source may use Celsius and
the other may use Fahrenheit, but you will tell the witnesses to
transform one into another so they can be averaged.</p>
<p>In this tutorial, you will be defining two data sources:</p>
<div class="superfences-tabs">
<input name="__tabs_3" type="radio" id="__tab_3_0" checked="checked" />
<label for="__tab_3_0">Source 1: Bitstamp</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="c1">// Retrieves USD price of a bitcoin from the BitStamp API</span>
<span class="kr">const</span> <span class="nx">bitstamp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Witnet</span><span class="p">.</span><span class="nx">Source</span><span class="p">(</span><span class="s2">&quot;https://www.bitstamp.net/api/ticker/&quot;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">asString</span><span class="p">()</span>  <span class="c1">// Treat the response as a string of text</span>
  <span class="p">.</span><span class="nx">parseJSON</span><span class="p">()</span> <span class="c1">// Parse the string, which you now to be JSON-encoded</span>
  <span class="p">.</span><span class="nx">asMap</span><span class="p">()</span>     <span class="c1">// Treat that as a Javascript object</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;last&quot;</span><span class="p">)</span> <span class="c1">// Get the value associated to the `last` key</span>
  <span class="p">.</span><span class="nx">asFloat</span><span class="p">()</span>   <span class="c1">// Treat that as a floating point number</span>
</pre></div></div>
<input name="__tabs_3" type="radio" id="__tab_3_1" />
<label for="__tab_3_1">Source 2: CoinDesk</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="c1">// Retrieves USD price of a bitcoin from CoinDesk&#39;s &quot;bitcoin price index&quot; API</span>
<span class="c1">// The JSON here is a bit more complex, thus more operators are needed</span>
<span class="kr">const</span> <span class="nx">coindesk</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Witnet</span><span class="p">.</span><span class="nx">Source</span><span class="p">(</span><span class="s2">&quot;https://api.coindesk.com/v1/bpi/currentprice.json&quot;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">asString</span><span class="p">()</span>        <span class="c1">// Treat the response as a string of text</span>
  <span class="p">.</span><span class="nx">parseJSON</span><span class="p">()</span>       <span class="c1">// Parse the string, which you now to be JSON-encoded</span>
  <span class="p">.</span><span class="nx">asMap</span><span class="p">()</span>           <span class="c1">// Treat that as a Javascript object</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;bpi&quot;</span><span class="p">)</span>        <span class="c1">// Get the value associated to the `last` key</span>
  <span class="p">.</span><span class="nx">asMap</span><span class="p">()</span>           <span class="c1">// Treat that as a Javascript object</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;USD&quot;</span><span class="p">)</span>        <span class="c1">// Get the value associated to the `last` key</span>
  <span class="p">.</span><span class="nx">asMap</span><span class="p">()</span>           <span class="c1">// Treat that as a Javascript object</span>
  <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;rate_float&quot;</span><span class="p">)</span> <span class="c1">// Get the value associated to the `last` key</span>
  <span class="p">.</span><span class="nx">asFloat</span><span class="p">()</span>         <span class="c1">// Treat that as a floating point number</span>
</pre></div></div>
</div>
<p>These scripts are quite self-explanatory, but there are a few details
that are worth noticing:</p>
<ul>
<li>The operators and data types that can be used are defined by the
  <a href="/protocol/data-requests/overview/#rad-object-notation-radon">RADON domain-specific language</a>.</li>
<li>Each operator is applied on the output of the previous operator.</li>
<li>Source scripts always start with a binary stream of bytes<sup id="fnref:1"><a class="footnote-ref" href="#fn:1" rel="footnote">1</a></sup>, hence
  the need for the <code class="codehilite"><span class="na">.asString</span><span class="p">()</span></code> operator.</li>
<li>Type conversions are explicit, i.e. you need to use <code class="codehilite"><span class="na">.asString</span><span class="p">()</span></code>,
  <code class="codehilite"><span class="na">.asMap</span><span class="p">()</span></code>, <code class="codehilite"><span class="na">.asFloat</span><span class="p">()</span></code>, etc.</li>
<li>Key-value data structures (alike to Javascript objects) are called
  <em>maps</em>.</li>
<li>Values in maps cannot be accessed directly by name as <code class="codehilite"><span class="na">.keyName</span></code> but
  rather accessed through a call to the <code class="codehilite"><span class="na">.get</span><span class="p">(</span><span class="s">&quot;keyName&quot;</span><span class="p">)</span></code> operator.</li>
<li>The final return type of a script is that of its last operator. </li>
<li>All source scripts should return exactly the same type (<code class="codehilite">Float</code> in
  this case).</li>
</ul>
<h3 id="define-the-aggregator-script">Define the aggregator script<a class="headerlink" href="#define-the-aggregator-script" title="Permanent link">&para;</a></h3>
<p><em>Good</em>. Now it is time for defining how you want the witnesses to reduce
the results of the different sources into the single data point that
they will report.</p>
<p>Every data request needs exactly one aggregator script, which can be
written using the same syntax, types and operators as source scripts and
just any other kind of Witnet scripts.</p>
<p>Here goes your aggregator script:</p>
<div class="codehilite"><pre><span></span><span class="kr">const</span> <span class="nx">aggregator</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Witnet</span><span class="p">.</span><span class="nx">Aggregator</span><span class="p">([</span><span class="nx">coindesk</span><span class="p">,</span> <span class="nx">bitstamp</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">flatten</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">Witnet</span><span class="p">.</span><span class="nx">Filters</span><span class="p">.</span><span class="nx">deviationStandard</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">Witnet</span><span class="p">.</span><span class="nx">Reducers</span><span class="p">.</span><span class="nx">averageMean</span><span class="p">)</span>
</pre></div>

<p>This may look simpler than the source scripts, but there are some
details that deserve some special attention:</p>
<ul>
<li>When creating aggregator scripts you need to specify the sources on
  which it will be applied (<code class="codehilite">[bitstamp, coindesk]</code> in the example) so
  the compiler knows the input type and can check for uniformity.</li>
<li>All aggregator scripts start with an <code class="codehilite">Array</code> containing as many items
  as sources, where those items can be <code class="codehilite">Result::Ok(value)</code> or
  <code class="codehilite">Result::Err(errorMessage)</code>:
  <div class="codehilite"><pre><span></span><span class="p">[</span><span class="w"> </span><span class="nb">Result</span>::<span class="nb">Ok</span><span class="p">(</span><span class="mi">10284</span><span class="p">),</span><span class="w"> </span><span class="nb">Result</span>::<span class="nb">Ok</span><span class="p">(</span><span class="mi">10291</span><span class="p">)</span><span class="w"> </span><span class="p">]</span><span class="w">             </span><span class="c1">// Both sources succeeded</span>
<span class="p">[</span><span class="w"> </span><span class="nb">Result</span>::<span class="nb">Ok</span><span class="p">(</span><span class="mi">10284</span><span class="p">),</span><span class="w"> </span><span class="nb">Result</span>::<span class="nb">Err</span><span class="p">(</span><span class="s">&quot;404: Not Found&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="c1">// The second source failed</span>
</pre></div></li>
<li>The <code class="codehilite"><span class="na">.flatten</span><span class="p">()</span></code> operator removes all <code class="codehilite">Result::Err(errorMessage)</code>
  items, i.e. it gets rid of any source that failed to respond,
  responded with an error code or whose companion script failed to
  execute.</li>
<li>You can filter the remaining source responses using any of the
  available filters. The one you are using here is specially powerful,
  as it removes any data point that falls twice as far from the average
  as the standard deviation of the entire <code class="codehilite">Array</code>. <em>Clever, huh?</em></li>
<li>Finally, you are telling the witnesses to calculate the arithmetic 
  mean of the remaining data points and report the result so that the
  request can move on to the final stage of the request: the tally.</li>
</ul>
<h3 id="define-the-tally-script">Define the tally script<a class="headerlink" href="#define-the-tally-script" title="Permanent link">&para;</a></h3>
<p>This far you have created a couple of data sources and then an
aggregator script that reduces them down to a single data point.</p>
<p>But the fun does not end here. You actually want several nodes to
perform the retrieval and aggregation separately. Guess how can you
specify how to reduce their respective results into the single data
point that your smart contract will be expecting? <em>Ok, you saw it
coming</em>: with another script.</p>
<p>Tally scripts are very much alike to aggregator scripts, being the main
difference that they operate on the results coming from different nodes
instead of different data sources.</p>
<p>Once again, tally scripts are written using the same syntax and types as
source and aggregator scripts, however, a few operators are disabled for
security reasons<sup id="fnref:2"><a class="footnote-ref" href="#fn:2" rel="footnote">2</a></sup>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>One another point you should have in mind is that any witness node
whose reported result is discarded by the filters in the tally
script will receive no rewards. In other words, only those nodes
whose results pass all the filters will be taken into account during
rewards distribution.</p>
</div>
<p>Here goes your tally script:</p>
<div class="codehilite"><pre><span></span><span class="kr">const</span> <span class="nx">tally</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Tally</span><span class="p">(</span><span class="nx">aggregator</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">flatten</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">Witnet</span><span class="p">.</span><span class="nx">Filters</span><span class="p">.</span><span class="nx">deviationStandard</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">Witnet</span><span class="p">.</span><span class="nx">Filters</span><span class="p">.</span><span class="nx">averageMean</span><span class="p">)</span>
</pre></div>

<p>As you can see, tally scripts tend to be quite similar to aggregator
scripts. In this case, the only two differences are:</p>
<ul>
<li>The aggregator script needs to be passed to the <code class="codehilite">Tally</code> constructor it
  knows what is the input type.</li>
<li>The harshness of the deviation filter has been fine tuned (from <code class="codehilite">2</code> to
  <code class="codehilite">1.5</code>) to produce a higher-quality result as more outliers will be
  left out of the final value—and out of the rewards distribution too.</li>
</ul>
<h3 id="put-everything-together">Put everything together<a class="headerlink" href="#put-everything-together" title="Permanent link">&para;</a></h3>
<p>You have already created every single piece that make up a data request.
<em>You are almost there!</em></p>
<p>Now it is time to put them all together and set some final parameters:</p>
<div class="codehilite"><pre><span></span><span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Request</span><span class="p">()</span> <span class="c1">// Create a new request</span>
  <span class="p">.</span><span class="nx">addSource</span><span class="p">(</span><span class="nx">bitstamp</span><span class="p">)</span>        <span class="c1">// Adds Bitstamp as a source</span>
  <span class="p">.</span><span class="nx">addSource</span><span class="p">(</span><span class="nx">coindesk</span><span class="p">)</span>        <span class="c1">// Adds CoinDesk as a source</span>
  <span class="p">.</span><span class="nx">setAggregator</span><span class="p">(</span><span class="nx">aggregator</span><span class="p">)</span>  <span class="c1">// Set aggregation function</span>
  <span class="p">.</span><span class="nx">setTally</span><span class="p">(</span><span class="nx">tally</span><span class="p">)</span>            <span class="c1">// Set tally function</span>
  <span class="p">.</span><span class="nx">setWitnessCount</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>      <span class="c1">// Require between 4 and 6 witnessing nodes</span>
  <span class="p">.</span><span class="nx">schedule</span><span class="p">(</span><span class="mi">1669852800</span><span class="p">)</span>       <span class="c1">// Schedule for a specific date in the future</span>

<span class="kr">export</span> <span class="p">{</span> <span class="nx">request</span> <span class="nx">as</span> <span class="k">default</span> <span class="p">}</span> <span class="c1">// IMPORTANT: export the request as an ES6 module</span>
</pre></div>

<h2 id="next-steps">Next steps<a class="headerlink" href="#next-steps" title="Permanent link">&para;</a></h2>
<p>At this point, you have a Javascript module that when imported into your
own projects will produce a valid Witnet data request containing the
<a href="/protocol/data-requests/overview/#rad-object-notation-radon">RADON scripts</a> that Witnet nodes can parse and execute.</p>
<p>But how can you actually send the request to the network and have it
resolved by a randomly selected sample of Witnet nodes?</p>
<p>From here, you have a couple of options:</p>
<ul>
<li><a href="/try/use-from-ethereum">Send the data request from an Ethereum smart contract</a> and
  have the result resolve the outcome of the contract .</li>
<li><a href="/interfaces/json-rpc/#postDataRequest">Post the data request directly into Witnet</a> just for
  the sake of attesting the data point without triggering any onchain
  consequence.</li>
</ul>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>The Witnet protocol makes no assumptions on what the data type of
the response will be for different data sources. This allows dealing
with formats other than plain text, such as multimedia files and any
other kind of binaries. Thus, source scripts always start with <code class="codehilite">Bytes</code>
as the input type and it is totally up to the requester to specify
whether those bytes should be interpreted as a <code class="codehilite">String</code>, <code class="codehilite">Integer</code> or
whatnot.&#160;<a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Using operators like <code class="codehilite">Array::get()</code>, <code class="codehilite">Array::sort()</code> and
<code class="codehilite">Array::take()</code> as well as the <code class="codehilite">minimum</code> and <code class="codehilite">maximum</code> reducer functions
in a consensus script makes the result of the request too easily
influenced by each individual witness node and can therefore introduce
spurious incentives to tamper with request so as to maximize their own
profit at the expense of data integrity.&#160;<a class="footnote-backref" href="#fnref:2" rev="footnote" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            © 2018-2019 The Witnet Community. Available under <a href="https://www.gnu.org/licenses/fdl-1.3.en.html" rel="license">GNU Free Documentation License v1.3</a>
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/witnet" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://reddit.com/r/witnet" class="md-footer-social__link fa fa-reddit"></a>
    
      <a href="https://twitter.com/witnet_io" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.9e1f3b71.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../extra.js"></script>
      
    
    
      
    
  </body>
</html>